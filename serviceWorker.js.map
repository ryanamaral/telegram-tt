{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/config.ts","webpack:///./node_modules/process/browser.js","webpack:///./src/serviceWorker/progressive.ts","webpack:///./src/util/generateIdFor.ts","webpack:///./src/util/schedulers.ts","webpack:///./src/serviceWorker/pushNotification.ts","webpack:///./src/serviceWorker.ts","webpack:///./src/serviceWorker/assetCache.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","APP_NAME","DEBUG","process","env","APP_VERSION","MEDIA_PROGRESSIVE_CACHE_DISABLED","MEDIA_PROGRESSIVE_CACHE_NAME","MEDIA_CACHE_MAX_BYTES","ASSET_CACHE_NAME","Set","window","innerHeight","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","setTimeout","e","this","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","marker","runClearTimeout","Item","array","noop","nextTick","args","Array","arguments","push","apply","title","browser","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","requestStates","Map","async","respondForProgressive","url","request","range","headers","bytes","exec","start","Number","originalEnd","end","match","fileSize","mimeType","Response","Uint8Array","buffer","status","statusText","cacheKey","cachedArrayBuffer","cachedHeaders","cache","self","caches","open","Promise","all","then","arrayBuffer","undefined","json","fetchFromCache","console","log","Boolean","partInfo","params","clientId","client","clients","messageId","store","id","String","Math","random","replace","generateIdFor","requestState","promise","race","ms","resolve","reject","assign","set","catch","finally","delete","postMessage","type","requestPart","err","error","fullSize","partSize","min","byteLength","arrayBufferPart","slice","put","Request","JSON","stringify","saveToCache","addEventListener","result","data","clickBuffer","shownNotifications","getChatId","custom","from_id","parseInt","chat_id","channel_id","getMessageId","msg_id","showNotification","chatId","body","registration","icon","badge","vibrate","focusChatMessage","payload","focus","warn","ASSET_CACHE_PATTERN","waitUntil","skipWaiting","claim","respondWith","includes","startsWith","cached","remote","fetch","clone","respondWithCache","getPushData","mute","True","notification","description","getNotificationData","has","close","clientsInScope","matchAll","filter","scope","map","openWindow","newClient","notifyClients","source","add"],"mappings":"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","file":"serviceWorker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","export const PAGE_TITLE = 'Telegram';\nexport const INACTIVE_MARKER = ' [Inactive]';\n\nexport const APP_NAME = 'Telegram WebZ';\nexport const APP_VERSION = process.env.APP_VERSION || 'dev';\n\nexport const DEBUG = (\n  process.env.APP_ENV !== 'production' && process.env.APP_ENV !== 'perf' && process.env.APP_ENV !== 'test'\n);\nexport const DEBUG_MORE = false;\n\nexport const IS_TEST = process.env.APP_ENV === 'test';\nexport const IS_PERF = process.env.APP_ENV === 'perf';\n\nexport const DEBUG_ALERT_MSG = 'Shoot!\\nSomething went wrong, please see the error details in Dev Tools Console.';\nexport const DEBUG_GRAMJS = false;\n\nexport const GRAMJS_SESSION_ID_KEY = 'GramJs:sessionId';\nexport const LEGACY_SESSION_KEY = 'user_auth';\n\nexport const GLOBAL_STATE_CACHE_DISABLED = false;\nexport const GLOBAL_STATE_CACHE_KEY = 'tt-global-state';\nexport const GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT = 30;\nexport const GLOBAL_STATE_CACHE_USER_LIST_LIMIT = 5000;\n\nexport const MEDIA_CACHE_DISABLED = false;\nexport const MEDIA_CACHE_NAME = 'tt-media';\nexport const MEDIA_CACHE_NAME_AVATARS = 'tt-media-avatars';\nexport const MEDIA_PROGRESSIVE_CACHE_DISABLED = false;\nexport const MEDIA_PROGRESSIVE_CACHE_NAME = 'tt-media-progressive';\nexport const MEDIA_CACHE_MAX_BYTES = 512 * 1024; // 512 KB\nexport const CUSTOM_BG_CACHE_NAME = 'tt-custom-bg';\nexport const LANG_CACHE_NAME = 'tt-lang-packs-v3';\nexport const ASSET_CACHE_NAME = 'tt-assets';\n\nexport const API_UPDATE_THROTTLE = 300;\nexport const API_THROTTLE_RESET_UPDATES = new Set([\n  'newMessage', 'newScheduledMessage', 'deleteMessages', 'deleteScheduledMessages', 'deleteHistory',\n]);\n\nexport const DOWNLOAD_WORKERS = 16;\nexport const UPLOAD_WORKERS = 16;\n\nconst isBigScreen = typeof window !== 'undefined' && window.innerHeight >= 900;\n\nexport const MIN_PASSWORD_LENGTH = 1;\n\nexport const MESSAGE_LIST_SENSITIVE_AREA = 750;\nexport const MESSAGE_LIST_SLICE = isBigScreen ? 60 : 40;\nexport const MESSAGE_LIST_VIEWPORT_LIMIT = MESSAGE_LIST_SLICE * 2;\n\nexport const CHAT_HEIGHT_PX = 72;\nexport const CHAT_LIST_SLICE = isBigScreen ? 30 : 25;\nexport const CHAT_LIST_LOAD_SLICE = 100;\nexport const SHARED_MEDIA_SLICE = 42;\nexport const MESSAGE_SEARCH_SLICE = 42;\nexport const GLOBAL_SEARCH_SLICE = 20;\nexport const MEMBERS_SLICE = 30;\nexport const MEMBERS_LOAD_SLICE = 200;\nexport const PINNED_MESSAGES_LIMIT = 50;\nexport const BLOCKED_LIST_LIMIT = 100;\nexport const PROFILE_PHOTOS_LIMIT = 40;\nexport const PROFILE_SENSITIVE_AREA = 500;\n\nexport const TOP_CHAT_MESSAGES_PRELOAD_LIMIT = 20;\nexport const ALL_CHATS_PRELOAD_DISABLED = false;\n\nexport const ANIMATION_LEVEL_MIN = 0;\nexport const ANIMATION_LEVEL_MED = 1;\nexport const ANIMATION_LEVEL_MAX = 2;\nexport const ANIMATION_LEVEL_DEFAULT = ANIMATION_LEVEL_MAX;\n\nexport const DEFAULT_MESSAGE_TEXT_SIZE_PX = 16;\n\nexport const DRAFT_DEBOUNCE = 10000; // 10s\n\nexport const EDITABLE_INPUT_ID = 'editable-message-text';\nexport const EDITABLE_INPUT_MODAL_ID = 'editable-message-text-modal';\n\n// Screen width where Pinned Message / Audio Player in the Middle Header can be safely displayed\nexport const SAFE_SCREEN_WIDTH_FOR_STATIC_RIGHT_COLUMN = 1440; // px\n// Screen width where Pinned Message / Audio Player in the Middle Header shouldn't collapse with ChatInfo\nexport const SAFE_SCREEN_WIDTH_FOR_CHAT_INFO = 1150; // px\n\nexport const MIN_SCREEN_WIDTH_FOR_STATIC_RIGHT_COLUMN = 1275; // px\nexport const MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN = 925; // px\nexport const MOBILE_SCREEN_MAX_WIDTH = 600; // px\nexport const MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH = 950; // px\nexport const MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT = 450; // px\n\nexport const LOCAL_MESSAGE_ID_BASE = 1e9;\n\nexport const ANIMATION_END_DELAY = 100;\n\nexport const STICKER_SIZE_INLINE_DESKTOP_FACTOR = 13;\nexport const STICKER_SIZE_INLINE_MOBILE_FACTOR = 11;\nexport const STICKER_SIZE_AUTH = 160;\nexport const STICKER_SIZE_AUTH_MOBILE = 120;\nexport const STICKER_SIZE_PICKER = 64;\nexport const STICKER_SIZE_GENERAL_SETTINGS = 48;\nexport const STICKER_SIZE_PICKER_HEADER = 32;\nexport const STICKER_SIZE_SEARCH = 64;\nexport const STICKER_SIZE_MODAL = 64;\nexport const STICKER_SIZE_TWO_FA = 160;\nexport const STICKER_SIZE_DISCUSSION_GROUPS = 140;\nexport const STICKER_SIZE_FOLDER_SETTINGS = 80;\nexport const MEMOJI_STICKER_ID = 'MEMOJI_STICKER';\n\nexport const MENU_TRANSITION_DURATION = 200;\nexport const SLIDE_TRANSITION_DURATION = 450;\nexport const LAYERS_TRANSITION_DURATION = 450;\n\nexport const CONTENT_TYPES_FOR_QUICK_UPLOAD = 'image/png,image/gif,image/jpeg,video/mp4,video/avi,video/quicktime';\n\n// eslint-disable-next-line max-len\nexport const RE_LINK_TEMPLATE = '((ftp|https?):\\\\/\\\\/)?((www\\\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\\\.[a-zA-Z0-9()]{1,6})\\\\b([-a-zA-Z0-9()@:%_+.~#?&/=]*)';\nexport const RE_TME_LINK = /^(?:https?:\\/\\/)?(?:t\\.me\\/)([\\d\\w_]+)(?:\\/([\\d]+))?$/gm;\nexport const RE_TME_INVITE_LINK = /^(?:https?:\\/\\/)?(?:t\\.me\\/joinchat\\/)([\\d\\w_]+)?$/gm;\n\n// MTProto constants\nexport const SERVICE_NOTIFICATIONS_USER_ID = 777000;\nexport const ALL_FOLDER_ID = 0;\nexport const ARCHIVED_FOLDER_ID = 1;\nexport const DELETED_COMMENTS_CHANNEL_ID = 777;\nexport const MAX_MEDIA_FILES_FOR_ALBUM = 10;\nexport const MAX_ACTIVE_PINNED_CHATS = 5;\nexport const SCHEDULED_WHEN_ONLINE = 0x7FFFFFFE;\nexport const DEFAULT_LANG_PACK = 'android';\nexport const LANG_PACKS = ['android', 'ios', 'tdesktop', 'macos'];\nexport const TIPS_USERNAME = 'TelegramTips';\nexport const FEEDBACK_URL = 'https://bugs.telegram.org/?tag_ids=41&sort=time';\nexport const LIGHT_THEME_BG_COLOR = '#A2AF8E';\nexport const DARK_THEME_BG_COLOR = '#0F0F0F';\nexport const DARK_THEME_PATTERN_COLOR = '#0a0a0a8c';\nexport const DEFAULT_PATTERN_COLOR = 'rgba(90, 110, 70, 0.6)';\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import { pause } from '../util/schedulers';\nimport generateIdFor from '../util/generateIdFor';\nimport {\n  DEBUG,\n  MEDIA_CACHE_MAX_BYTES,\n  MEDIA_PROGRESSIVE_CACHE_DISABLED,\n  MEDIA_PROGRESSIVE_CACHE_NAME,\n} from '../config';\n\ndeclare const self: ServiceWorkerGlobalScope;\n\ntype PartInfo = {\n  type: 'PartInfo';\n  arrayBuffer: ArrayBuffer;\n  mimeType: 'string';\n  fullSize: number;\n};\n\ntype RequestStates = {\n  resolve: (response: PartInfo) => void;\n  reject: () => void;\n};\n\nconst MB = 1024 * 1024;\nconst DEFAULT_PART_SIZE = 0.5 * MB;\nconst MAX_END_TO_CACHE = 2 * MB - 1; // We only cache the first 2 MB of each file\nconst PART_TIMEOUT = 30000;\n\nconst requestStates = new Map<string, RequestStates>();\n\nexport async function respondForProgressive(e: FetchEvent) {\n  const { url } = e.request;\n  const range = e.request.headers.get('range');\n  const bytes = /^bytes=(\\d+)-(\\d+)?$/g.exec(range || '')!;\n  const start = Number(bytes[1]);\n  const originalEnd = Number(bytes[2]);\n\n  let end = originalEnd;\n  if (!end || (end - start + 1) > DEFAULT_PART_SIZE) {\n    end = start + DEFAULT_PART_SIZE - 1;\n  }\n\n  // Optimization for Safari\n  if (start === 0 && end === 1) {\n    const match = e.request.url.match(/fileSize=(\\d+)&mimeType=([\\w/]+)/);\n    const fileSize = match && Number(match[1]);\n    const mimeType = match && match[2];\n\n    if (fileSize && mimeType) {\n      return new Response(new Uint8Array(2).buffer, {\n        status: 206,\n        statusText: 'Partial Content',\n        headers: [\n          ['Content-Range', `bytes 0-1/${fileSize}`],\n          ['Accept-Ranges', 'bytes'],\n          ['Content-Length', '2'],\n          ['Content-Type', mimeType],\n        ],\n      });\n    }\n  }\n\n  const cacheKey = `${url}?start=${start}&end=${end}`;\n  const [cachedArrayBuffer, cachedHeaders] = !MEDIA_PROGRESSIVE_CACHE_DISABLED ? await fetchFromCache(cacheKey) : [];\n\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log(\n      `FETCH PROGRESSIVE ${cacheKey} (request: ${start}-${originalEnd}) CACHED: ${Boolean(cachedArrayBuffer)}`,\n    );\n  }\n\n  if (cachedArrayBuffer) {\n    return new Response(cachedArrayBuffer, {\n      status: 206,\n      statusText: 'Partial Content',\n      headers: cachedHeaders,\n    });\n  }\n\n  let partInfo;\n  try {\n    partInfo = await requestPart(e, { url, start, end });\n  } catch (err) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.error('FETCH PROGRESSIVE', err);\n    }\n  }\n\n  if (!partInfo) {\n    return new Response('', {\n      status: 500,\n      statusText: 'Failed to fetch progressive part',\n    });\n  }\n\n  const { arrayBuffer, fullSize, mimeType } = partInfo;\n\n  const partSize = Math.min(end - start + 1, arrayBuffer.byteLength);\n  end = start + partSize - 1;\n  const arrayBufferPart = arrayBuffer.slice(0, partSize);\n  const headers = [\n    ['Content-Range', `bytes ${start}-${end}/${fullSize}`],\n    ['Accept-Ranges', 'bytes'],\n    ['Content-Length', String(partSize)],\n    ['Content-Type', mimeType],\n  ];\n\n  if (!MEDIA_PROGRESSIVE_CACHE_DISABLED && partSize <= MEDIA_CACHE_MAX_BYTES && end < MAX_END_TO_CACHE) {\n    saveToCache(cacheKey, arrayBufferPart, headers);\n  }\n\n  return new Response(arrayBufferPart, {\n    status: 206,\n    statusText: 'Partial Content',\n    headers,\n  });\n}\n\n// We can not cache 206 responses: https://github.com/GoogleChrome/workbox/issues/1644#issuecomment-638741359\nasync function fetchFromCache(cacheKey: string) {\n  const cache = await self.caches.open(MEDIA_PROGRESSIVE_CACHE_NAME);\n\n  return Promise.all([\n    cache.match(`${cacheKey}&type=arrayBuffer`).then((r) => (r ? r.arrayBuffer() : undefined)),\n    cache.match(`${cacheKey}&type=headers`).then((r) => (r ? r.json() : undefined)),\n  ]);\n}\n\nasync function saveToCache(cacheKey: string, arrayBuffer: ArrayBuffer, headers: HeadersInit) {\n  const cache = await self.caches.open(MEDIA_PROGRESSIVE_CACHE_NAME);\n\n  return Promise.all([\n    cache.put(new Request(`${cacheKey}&type=arrayBuffer`), new Response(arrayBuffer)),\n    cache.put(new Request(`${cacheKey}&type=headers`), new Response(JSON.stringify(headers))),\n  ]);\n}\n\nasync function requestPart(\n  e: FetchEvent,\n  params: { url: string; start: number; end: number },\n): Promise<PartInfo | undefined> {\n  if (!e.clientId) {\n    return undefined;\n  }\n\n  // eslint-disable-next-line no-restricted-globals\n  const client = await self.clients.get(e.clientId);\n  if (!client) {\n    return undefined;\n  }\n\n  const messageId = generateIdFor(requestStates);\n  const requestState = {} as RequestStates;\n\n  const promise = Promise.race([\n    pause(PART_TIMEOUT).then(() => Promise.reject(new Error('ERROR_PART_TIMEOUT'))),\n    new Promise<PartInfo>((resolve, reject) => {\n      Object.assign(requestState, { resolve, reject });\n    }),\n  ]);\n\n  requestStates.set(messageId, requestState);\n  promise\n    .catch(() => undefined)\n    .finally(() => {\n      requestStates.delete(messageId);\n    });\n\n  client.postMessage({\n    type: 'requestPart',\n    messageId,\n    params,\n  });\n\n  return promise;\n}\n\nself.addEventListener('message', (e) => {\n  const { type, messageId, result } = e.data as {\n    type: string;\n    messageId: string;\n    result: PartInfo;\n  };\n\n  if (type === 'partResponse') {\n    const requestState = requestStates.get(messageId);\n    if (requestState) {\n      requestState.resolve(result);\n    }\n  }\n});\n","export default (store: AnyLiteral) => {\n  let id;\n\n  do {\n    id = String(Math.random()).replace('0.', 'id');\n  } while (store.hasOwnProperty(id));\n\n  return id;\n};\n","type Scheduler =\n  typeof requestAnimationFrame\n  | typeof onTickEnd\n  | typeof runNow;\n\nexport function debounce<F extends AnyToVoidFunction>(\n  fn: F,\n  ms: number,\n  shouldRunFirst = true,\n  shouldRunLast = true,\n) {\n  let waitingTimeout: number | undefined;\n\n  return (...args: Parameters<F>) => {\n    if (waitingTimeout) {\n      clearTimeout(waitingTimeout);\n      waitingTimeout = undefined;\n    } else if (shouldRunFirst) {\n      // @ts-ignore\n      fn(...args);\n    }\n\n    // eslint-disable-next-line no-restricted-globals\n    waitingTimeout = self.setTimeout(() => {\n      if (shouldRunLast) {\n        // @ts-ignore\n        fn(...args);\n      }\n\n      waitingTimeout = undefined;\n    }, ms);\n  };\n}\n\nexport function throttle<F extends AnyToVoidFunction>(\n  fn: F,\n  ms: number,\n  shouldRunFirst = true,\n) {\n  let interval: number | undefined;\n  let isPending: boolean;\n  let args: Parameters<F>;\n\n  return (..._args: Parameters<F>) => {\n    isPending = true;\n    args = _args;\n\n    if (!interval) {\n      if (shouldRunFirst) {\n        isPending = false;\n        // @ts-ignore\n        fn(...args);\n      }\n\n      // eslint-disable-next-line no-restricted-globals\n      interval = self.setInterval(() => {\n        if (!isPending) {\n          // eslint-disable-next-line no-restricted-globals\n          self.clearInterval(interval!);\n          interval = undefined;\n          return;\n        }\n\n        isPending = false;\n        // @ts-ignore\n        fn(...args);\n      }, ms);\n    }\n  };\n}\n\nexport function throttleWithRaf<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(fastRaf, fn);\n}\n\nexport function throttleWithPrimaryRaf<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(fastPrimaryRaf, fn);\n}\n\nexport function throttleWithTickEnd<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(onTickEnd, fn);\n}\n\nexport function throttleWithNow<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(runNow, fn);\n}\n\nexport function throttleWith<F extends AnyToVoidFunction>(schedulerFn: Scheduler, fn: F) {\n  let waiting = false;\n  let args: Parameters<F>;\n\n  return (..._args: Parameters<F>) => {\n    args = _args;\n\n    if (!waiting) {\n      waiting = true;\n\n      schedulerFn(() => {\n        waiting = false;\n        // @ts-ignore\n        fn(...args);\n      });\n    }\n  };\n}\n\nexport function onTickEnd(cb: NoneToVoidFunction) {\n  Promise.resolve().then(cb);\n}\n\nexport function onIdle(cb: NoneToVoidFunction) {\n  // eslint-disable-next-line no-restricted-globals\n  if (self.requestIdleCallback) {\n    // eslint-disable-next-line no-restricted-globals\n    self.requestIdleCallback(cb);\n  } else {\n    onTickEnd(cb);\n  }\n}\n\nfunction runNow(fn: NoneToVoidFunction) {\n  fn();\n}\n\nexport const pause = (ms: number) => new Promise((resolve) => {\n  setTimeout(() => resolve(), ms);\n});\n\nexport function rafPromise() {\n  return new Promise((resolve) => {\n    fastRaf(resolve);\n  });\n}\n\nlet fastRafCallbacks: NoneToVoidFunction[] | undefined;\nlet fastRafPrimaryCallbacks: NoneToVoidFunction[] | undefined;\n\n// May result in an immediate execution if called from another `requestAnimationFrame` callback\nexport function fastRaf(callback: NoneToVoidFunction, isPrimary = false) {\n  if (!fastRafCallbacks) {\n    fastRafCallbacks = isPrimary ? [] : [callback];\n    fastRafPrimaryCallbacks = isPrimary ? [callback] : [];\n\n    requestAnimationFrame(() => {\n      const currentCallbacks = fastRafCallbacks!;\n      const currentPrimaryCallbacks = fastRafPrimaryCallbacks!;\n      fastRafCallbacks = undefined;\n      fastRafPrimaryCallbacks = undefined;\n      currentPrimaryCallbacks.forEach((cb) => cb());\n      currentCallbacks.forEach((cb) => cb());\n    });\n  } else if (isPrimary) {\n    fastRafPrimaryCallbacks!.push(callback);\n  } else {\n    fastRafCallbacks.push(callback);\n  }\n}\n\nexport function fastPrimaryRaf(callback: NoneToVoidFunction) {\n  fastRaf(callback, true);\n}\n","import { APP_NAME, DEBUG } from '../config';\n\ndeclare const self: ServiceWorkerGlobalScope;\n\nenum Boolean {\n  True = '1',\n  False = '0'\n}\n\ntype PushData = {\n  custom: {\n    msg_id?: string;\n    channel_id?: string;\n    chat_id?: string;\n    from_id?: string;\n  };\n  mute: Boolean;\n  badge: Boolean;\n  loc_key: string;\n  loc_args: string[];\n  random_id: number;\n  title: string;\n  description: string;\n};\n\ntype NotificationData = {\n  messageId?: number;\n  chatId?: number;\n  title: string;\n  body: string;\n};\n\nconst clickBuffer: Record<string, NotificationData> = {};\nconst shownNotifications = new Set();\n\nfunction getPushData(e: PushEvent | Notification): PushData | undefined {\n  try {\n    return e.data.json();\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.log('[SW] Unable to parse push notification data', e.data);\n    }\n    return undefined;\n  }\n}\n\nfunction getChatId(data: PushData) {\n  if (data.custom.from_id) {\n    return parseInt(data.custom.from_id, 10);\n  }\n  // Chats and channels have negative IDs\n  if (data.custom.chat_id) {\n    return parseInt(data.custom.chat_id, 10) * -1;\n  }\n  if (data.custom.channel_id) {\n    return parseInt(data.custom.channel_id, 10) * -1;\n  }\n  return undefined;\n}\n\nfunction getMessageId(data: PushData) {\n  if (!data.custom.msg_id) return undefined;\n  return parseInt(data.custom.msg_id, 10);\n}\n\nfunction getNotificationData(data: PushData): NotificationData {\n  return {\n    chatId: getChatId(data),\n    messageId: getMessageId(data),\n    title: data.title || APP_NAME,\n    body: data.description,\n  };\n}\n\nfunction showNotification({\n  chatId,\n  messageId,\n  body,\n  title,\n}: NotificationData) {\n  return self.registration.showNotification(title, {\n    body,\n    data: {\n      chatId,\n      messageId,\n    },\n    icon: 'icon-192x192.png',\n    badge: 'icon-192x192.png',\n    vibrate: [200, 100, 200],\n  });\n}\n\nexport function handlePush(e: PushEvent) {\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('[SW] Push received event', e);\n    if (e.data) {\n      // eslint-disable-next-line no-console\n      console.log('[SW] Push received with data', e.data.json());\n    }\n  }\n  const data = getPushData(e);\n\n  // Do not show muted notifications\n  if (!data || data.mute === Boolean.True) return;\n\n  const notification = getNotificationData(data);\n\n  // Dont show already triggered notification\n  if (shownNotifications.has(notification.messageId)) {\n    shownNotifications.delete(notification.messageId);\n    return;\n  }\n\n  e.waitUntil(showNotification(notification));\n}\n\nasync function focusChatMessage(client: WindowClient, data: { chatId?: number; messageId?: number }) {\n  const {\n    chatId,\n    messageId,\n  } = data;\n  if (!chatId) return;\n  client.postMessage({\n    type: 'focusMessage',\n    payload: {\n      chatId,\n      messageId,\n    },\n  });\n  // Catch \"focus not allowed\" DOM Exceptions\n  try {\n    await client.focus();\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[SW] ', error);\n    }\n  }\n}\n\nexport function handleNotificationClick(e: NotificationEvent) {\n  const appUrl = process.env.APP_URL!;\n  e.notification.close(); // Android needs explicit close.\n  const { data } = e.notification;\n  const notifyClients = async () => {\n    const clients = await self.clients.matchAll({ type: 'window' }) as WindowClient[];\n    const clientsInScope = clients.filter((client) => client.url === self.registration.scope);\n    e.waitUntil(Promise.all(clientsInScope.map((client) => {\n      clickBuffer[client.id] = data;\n      return focusChatMessage(client, data);\n    })));\n    if (!self.clients.openWindow || clientsInScope.length > 0) return undefined;\n\n    // If there is no opened client we need to open one and wait until it is fully loaded\n    const newClient = await self.clients.openWindow(appUrl);\n    if (newClient) {\n      // Store notification data until client is fully loaded\n      clickBuffer[newClient.id] = data;\n    }\n    return undefined;\n  };\n  e.waitUntil(notifyClients());\n}\n\nexport function handleClientMessage(e: ExtendableMessageEvent) {\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('[SW] New message from client', e);\n  }\n  if (!e.data) return;\n  const source = e.source as WindowClient;\n  if (e.data.type === 'clientReady') {\n    // focus on chat message when client is fully ready\n    if (clickBuffer[source.id]) {\n      e.waitUntil(focusChatMessage(source, clickBuffer[source.id]));\n      delete clickBuffer[source.id];\n    }\n  }\n  if (e.data.type === 'newMessageNotification') {\n    // store messageId for already shown notification\n    const notification: NotificationData = e.data.payload;\n    e.waitUntil(showNotification(notification));\n    shownNotifications.add(notification.messageId);\n  }\n}\n","import { DEBUG } from './config';\nimport { respondForProgressive } from './serviceWorker/progressive';\nimport { respondWithCache, clearAssetCache } from './serviceWorker/assetCache';\nimport { handlePush, handleNotificationClick, handleClientMessage } from './serviceWorker/pushNotification';\n\ndeclare const self: ServiceWorkerGlobalScope;\n\nconst ASSET_CACHE_PATTERN = /[0-9a-f]{20}.*\\.(js|css|woff2?|svg|png|jpg|json|wasm)$/;\n\nself.addEventListener('install', (e) => {\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('ServiceWorker installed');\n  }\n\n  // Activate worker immediately\n  e.waitUntil(self.skipWaiting());\n});\n\nself.addEventListener('activate', (e) => {\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('ServiceWorker activated');\n  }\n\n  // Become available to all pages\n  e.waitUntil(clearAssetCache());\n  e.waitUntil(self.clients.claim());\n});\n\n// eslint-disable-next-line no-restricted-globals\nself.addEventListener('fetch', (e: FetchEvent) => {\n  e.respondWith((() => {\n    const { url } = e.request;\n\n    if (url.includes('/progressive/')) {\n      return respondForProgressive(e);\n    }\n\n    if (url.startsWith('http') && url.match(ASSET_CACHE_PATTERN)) {\n      return respondWithCache(e);\n    }\n\n    return fetch(e.request);\n  })());\n});\n\n\nself.addEventListener('push', handlePush);\nself.addEventListener('notificationclick', handleNotificationClick);\nself.addEventListener('message', handleClientMessage);\n","import { ASSET_CACHE_NAME } from '../config';\n\ndeclare const self: ServiceWorkerGlobalScope;\n\nexport async function respondWithCache(e: FetchEvent) {\n  const cache = await self.caches.open(ASSET_CACHE_NAME);\n  const cached = await cache.match(e.request);\n\n  if (cached) {\n    return cached;\n  }\n\n  const remote = await fetch(e.request);\n  cache.put(e.request, remote.clone());\n\n  return remote;\n}\n\nexport function clearAssetCache() {\n  return self.caches.delete(ASSET_CACHE_NAME);\n}\n"],"sourceRoot":""}